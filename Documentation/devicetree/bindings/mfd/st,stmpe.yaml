# SPDX-License-Identifier: GPL-2.0-only
%YAML 1.2
---
$id: http://devicetree.org/schemas/mfd/st,stmpe.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: ST Microelectronics STMPE Multi-Functional Device

maintainers:
  - Lee Jones <lee.jones@linaro.org>

description: |
  STMPE is an MFD device which may expose the following inbuilt devices: gpio, keypad,
  touchscreen, adc, pwm, rotator.

properties:
  compatible:
    enum:
      - st,stmpe610
      - st,stmpe801
      - st,stmpe811
      - st,stmpe1600
      - st,stmpe1601
      - st,stmpe2401
      - st,stmpe2403

  reg:
    maxItems: 1

  interrupts:
    maxItems: 1

  interrupt-controller:
    description: marks the device as an interrupt provider

  wakeup-source:
    description: marks the input device as wakable

  st,autosleep-timeout:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: auto-sleep timeout (in ms)
    enum: [ 4, 16, 32, 64, 128, 256, 512, 1024 ]

  irq-gpio:
    description: if present, specifies which GPIO to use for event IRQ

  # Optional properties for devices with touch and ADC (STMPE811|STMPE610):
  st,sample-time:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: ADC conversion time in number of clocks
    oneOf:
      - description: 36 clocks
        const: 0
      - description: 44 clocks
        const: 1
      - description: 56 clocks
        const: 2
      - description: 64 clocks
        const: 3
      - description: 80 clocks (recommended)
        const: 4
      - description: 96 clocks
        const: 5
      - description: 124 clocks
        const: 6

  st,mod-12b:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: ADC bit mode
    oneOf:
      - description: 10 bit ADC
        const: 0
      - description: 12 bit ADC
        const: 1

  st,ref-sel:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: ADC reference source
    oneOf:
      - description: internal
        const: 0
      - description: extenal
        const: 1

  st,adc-freq:
    $ref: /schemas/types.yaml#/definitions/uint32
    description: ADC clock speed
    oneOf:
      - description: 1.625 MHz
        const: 0
      - description: 3.25 MHz
        const: 1
      - description: 6.5 MHz
        const: 2
      - description: 6.5 MHz
        const: 3

  stmpe_adc:
    $ref: ../iio/adc/st,stmpe-adc.yaml

  stmpe_gpio:
    $ref: ../gpio/st,stmpe-gpio.yaml

  stmpe_keypad:
    $ref: ../input/st,stmpe-keypad.yaml

  stmpe_pwm:
    $ref: ../pwm/st,stmpe-pwm.yaml

  stmpe_touchscreen:
    $ref: ../input/touchscreen/st,stmpe-ts.yaml

additionalProperties: false

required:
  - compatible
  - reg
  - interrupt-controller

examples:
  - |
    i2c {
      #address-cells = <1>;
      #size-cells = <0>;

      stmpe1601@40 {
        compatible = "st,stmpe1601";
        reg = <0x40>;
        interrupts = <26 0x4>;
        interrupt-parent = <&gpio6>;
        interrupt-controller;

        wakeup-source;
        st,autosleep-timeout = <1024>;
      };
    };
