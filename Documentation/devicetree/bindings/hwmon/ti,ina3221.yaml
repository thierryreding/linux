# SPDX-License-Identifier: GPL-2.0-only
%YAML 1.2
---
$id: http://devicetree.org/schemas/hwmon/ti,ina3221.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Texas Instruments INA3221 Device Tree Bindings

maintainers:
  - Jean Delvare <jdelvare@suse.com>
  - Guenter Roeck <linux@roeck-us.net>

properties:
  compatible:
    const: ti,ina3221

  reg:
    maxItems: 1

  ti,single-shot:
    description: |
      This chip has two power modes: single-shot (chip takes one measurement and then shuts itself
      down) and continuous (chip takes continuous measurements). The continuous mode is more
      reliable and suitable for hardware monitor type device, but the single-shot mode is more
      power-friendly and useful for battery-powered device which cares power consumptions while
      still needs some measurements occasionally.

      If this property is present, the single-shot mode will be used, instead of the default
      continuous one for monitoring.
    $ref: /schemas/types.yaml#/definitions/flag

  "#address-cells":
    description: Required only if a child node is present.
    const: 1

  "#size-cells":
    description: Required only if a child node is present.
    const: 0

patternProperties:
  "^input@[0-2]$":
    description: The node contains optional child nodes for three channels. Each child node
      describes the information of input source.
    type: object
    properties:
      reg:
        description: Must be 0, 1 and 2, corresponding to the IN1, IN2 or IN3 ports of the INA3221,
          respectively.
        enum: [ 0, 1, 2 ]

      label:
        description: name of the input source

      shunt-resistor-micro-ohms:
        description: shunt resistor value in micro-Ohm

    additionalProperties: false

    required:
      - reg

additionalProperties: false

required:
  - compatible
  - reg

examples:
  - |
    #include <dt-bindings/clock/tegra186-clock.h>
    #include <dt-bindings/interrupt-controller/arm-gic.h>
    #include <dt-bindings/reset/tegra186-reset.h>

    i2c@3160000 {
        compatible = "nvidia,tegra186-i2c";
        reg = <0x03160000 0x10000>;
        interrupts = <GIC_SPI 25 IRQ_TYPE_LEVEL_HIGH>;
        clocks = <&bpmp TEGRA186_CLK_I2C1>;
        clock-names = "div-clk";
        resets = <&bpmp TEGRA186_RESET_I2C1>;
        reset-names = "i2c";

        #address-cells = <1>;
        #size-cells = <0>;

        ina3221@40 {
            compatible = "ti,ina3221";
            reg = <0x40>;
            #address-cells = <1>;
            #size-cells = <0>;

            input@0 {
                reg = <0x0>;
                status = "disabled";
            };

            input@1 {
                reg = <0x1>;
                shunt-resistor-micro-ohms = <5000>;
            };

            input@2 {
                reg = <0x2>;
                label = "VDD_5V";
                shunt-resistor-micro-ohms = <5000>;
            };
        };
    };
